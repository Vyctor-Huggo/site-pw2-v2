<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrinho de Compras</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th,
        td {
            padding: 8px;
            border-bottom: 1px solid #ddd;
        }

        .total {
            font-weight: bold;
        }
    </style>
</head>

<body>
    <h1>Carrinho de Compras</h1>

    <table id="carrinho">
        <thead>
            <tr>
                <th>Produto</th>
                <th>Preço</th>
                <th>Quantidade</th>
                <th>Total</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            <!-- Inserir itens do carrinho aqui -->
            {{{ tbody_att }}}
        </tbody>
        <tfoot>
            <tr>
                <td colspan="4" class="total">Total</td>
                <td id="total">R$ {{ total }}</td>
            </tr>
        </tfoot>
    </table>

    <script>
        function removerProduto(id) {
            fetch(`/loja/remover-produto/${id}`, {
                method: 'POST'
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Erro ao remover o produto do carrinho');
                }

                const produtoRow = document.querySelector(`#produto-${id}`);

                if (produtoRow) {
                    // Remover o elemento <tr> do DOM
                    produtoRow.remove();
                    window.location.reload();
                } else {
                    throw new Error('Produto não encontrado no carrinho');
                }
            })
            .catch(error => {
                console.error('Erro ao remover o produto:', error);
            });
        }
    </script>
</body>

</html>
